#

```
第3章 範圍界定
範圍界定（Target Scoping）是收集被測單位的評估專案需求的經驗過程。這個階段的工作把評估項目的毎一個需求參數都落實到項目的測試計畫、限定因素、業務指標和進度安排中。
該流程旨在明確安全評估專案的具體目標，對整個專案起著舉足輕重的重要作用。待明確專案的關鍵目標之後，評估人員就可以整理出工作路線圖。這份路線圖會涵蓋測試目標、測試方式、所需資源、限制因素、業務指標，以及項目的計畫和調度安排。我們把上述這些要素統稱為評估專案的範圍界定流程（scope process）。本章將介紹與之有關的幾個概念，分別如下。
● 收集需求（gathering client requirements）：以口頭交流或書面詢問的形式，積累目標環境的有關資訊。
● 籌畫工作（preparing test plan）：測試計畫的準備工作受許多因素的影響。這些因素包括：結構化測試流程按照實際需求進行的相應調整、合同和協議、成本分析以及資源配置。
● 邊界分析（profiling test boundaries）：明確滲透測試任務限制因素的工作。這些限制因素可能來自於技術上的限制、資訊方面的限制或者是客戶 IT 規章條例裡的有關要求。
● 明確業務指標（defining business objectives）：在滲透測試專案中，該階段工作使技術目標與業務目標保持一致。
● 專案管理和統籌調度（project management and scheduling）：該項工作旨在使滲透測試過程中的每個步驟與其他步驟形成時間上的配合。很多些先進的專案管理工具，都可以用做專案管理和專案調度的工具。


為了保證測試結果的一致性，提高測試工作的成功幾率，強烈建議您遵循評估專案的範圍界定流程。此外，您也可以根據實際情況和測試要素對該流程進行調整。如果脫離範圍界定流程，收集到的需求將不夠確切，工作的流程難以合理，而這都可能會導致測試專案的最終失敗。這不僅會危及整個滲透測試專案的成敗，並且有可能會意外中斷被測單位的正常業務。充分重視範圍界定階段的工作，會給後續各階段的工作帶來極大的幫助，並且有助於明確技術方面和管理方面的有關需求。範圍界定的關鍵在於，要在開始滲透之前盡可能的從客戶那裡收集資訊，以形成一個充分滿足客戶各個層面需求的滲透測試策略。這一策略應能顧全法律條款、合同協議、資源配置、測試限制、核心競爭力、基礎設施資訊、時間指標以及規則約定。滲透測試的最佳實踐表明，唯有遵循範圍界定流程，在這一階段解決所有必要的問題，才是啟動滲透測試專案的專業方式。
範圍界定流程的各個步驟負責生成不同類型的資訊。為了保障滲透測試的最終成功，範圍界定流程按照邏輯的順序把這些步驟有機地組合成一體。我們也要在這個階段儘早地處理好與法律有關的問題。在本章後續的小節裡，我們將詳細解釋這些階段的各個步驟。請注意，如果能夠條例清晰地整理好所有收集到的資訊，那麼客戶和滲透測試顧問都能夠深入理解安全測試的工作過程。
3.1 收集需求
這一步通常以問卷調查的形式從客戶那裡收集目標基礎設施的所有相關資訊。接受問卷調查的物件可以是經被測單位正式授權的個人和業務夥伴。因此，要保證順利完成滲透測試項目，關鍵是要在項目的早期找到所有內部和外部的干係人（stake holder），儘早分析他們對項目的關注程度、期望程度、重要程度和影響程度。然後，依據各個干係人的需求和參與程度制定測試策略，以在最大限度地發揮滲透測試的正面影響的同時，盡可能地避免潛在的負面影響。
在開展工作之前，事先驗證合同締約方的真實身份是測試人員的責任，而不是被測單位的責任。
收集需求的基本作用是：幫助滲透測試人員通過真實可信的管道獲取測試工作所需的必要資訊。當完成明確需求的工作之後，應把測試需求分析書交給客戶審查，以免受到錯誤資訊的誤導。審查步驟可以保證最終測試結果的一致性和完整性。
3.1.1 需求調查問卷
我們整理出部分常見問題，這些問題可以用作常規客戶需求調查問卷的製作基礎。需要注意的是，您需要根據客戶的需求擴展或精簡其中的問題。
● 收集公司的基本資訊，例如公司名稱、註冊地址、企業網站、聯絡人的詳細資料、電子郵寄地址以及電話號碼。
● 瞭解客戶啟動滲透測試專案的主要動機。
● 確定滲透測試的具體類型（包含或者不包含特定標準）。
○ 黑盒測試
○ 白盒測試
○ 外部測試
○ 內部測試
○ 需要進行社會工程學測試
○ 不進行社會工程學測試
○ 調査員工背景資訊
○ 使用偽造的員工資訊進行測試（可能需要諮詢律師）
○ 進行DoS（拒絕服務攻擊）測試
○ 不進行DoS 測試
○ 滲透業務合作夥伴的系統
● 測試專案涉及多少伺服器、工作站和網路設備？
● 基礎設施架構支援什麼作業系統技術？
● 需要測試什麼類型的網路設備？防火牆、路由器、交換機、數據機、負載平衡器、IDS、IPS，還是其他類型的硬體設備？
● 是否有災難恢復計畫？如果有，誰是測試人員應當聯繫的緊急連絡人？
● 是否有在崗的網路系統管理員？
● 是否需要遵循什麼特定的工業標準？如果有，請列出來。
● 當前滲透測試項目的聯絡人是誰？
● 這個項目的時間週期是多久？
● 這個專案的預算是多少？
● 如果必要，應全面掌握客戶在其他方面的需求。
3.1.2 可交付成果的需求調查表
下述列表是可交付成果的需求調查表（deliverable assessment form）。這個調查表的內容並不全面，您應該根據客戶的需求進行相應添增或刪減。
● 您期望得到哪種類型的報告？
○ 執行報告
○ 技術評估報告
○ 開發人員報告
● 您希望專案報告採用哪種檔案格式？ PDF、HTML 還是DOC。
● 提交報告的方式，應當是加密郵件還是紙質文檔？
● 負責收取這些報告的責任人是誰？
○ 員工
○ 股東
○ 干係人
這種簡潔而全面的調査表，有助您毫不費力地掌握客戶的需求，有助於順利完成測試計畫。
3.2 籌畫工作
在收集完客戶需求並由客戶驗證過這些需求之後，就可開始正式測試計畫的準備工作。測試計畫必須能夠反映客戶的全部需求，應能全面解決測試工作在法律和商業領域會涉及的各種問題。籌畫測試工作的有關計畫，關鍵是要制定一種嚴謹的測試流程，解決好人員配置、成本分析、保密協議、滲透測試合同以及操作規則的問題。下面將具體討論這些方面的工作。
● 制定嚴謹的測試流程：在分析完客戶回饋的詳細資料之後，您可能需要適度調整現有的測試方法論。例如，如果客戶不希望進行社會工程學測試，那麼正式的測試流程就不得有該項測試。有些人把這種調整工作稱為測試過程驗證（Test Process Validation）。這種調整工作往往需要進行多次；每當客戶改動了他們的需求，測試人員都需要重新進行相應的調整工作。如果測試計畫裡包含任何客戶需求範圍之外的測試，將有可能違反單位的制度，甚至造成嚴重後果。此外，測試人員通常還要按照測試類型的區別對測試流程進行一定的調整。例如，白盒測試的測試計畫就不應該包含資訊收集和目標識別的相關階段，因為測試人員事前能夠掌握目標內部架構的詳細情況。
無論進行何種類型的測試，測試人員都應當驗證網路資訊和實際環境。畢竟，客戶自己可能並不知道他們的網路結構到底是什麼情況。
● 人員配置：測試人員的知識結構和專業水準是影響測試工作成敗的重要因素之一。因此，為既定任務指定一名水準相當的專業滲透測試人員，可提高安全評估結果的品質。例如，要開展針對應用程式的滲透任務，我們就需要應用安全方面的測試人員。這項工作對於滲透測試任務的成功完成具有非常重要的作用。
● 成本分析：滲透測試的成本取決於很多因素。可能影響成本的因素包括：分配給整個專案的天數、客戶要求的額外服務（如社會工程學和物理安全評估）、評估特定技術所要求的專業能力。以行業的觀點來看，成本取決於測試項目的性質（種類）和數量（工作量）。
● 保密協議（Non-disclosure Agreement，NDA）：在滲透測試開始之前，合同雙方需要簽訂符合雙方利益的協議。這份保密協議用來明確測試工作中各方應該遵循的條款和條件。在整個測試過程中，滲透測試人員必須遵守這些條款。違反保密協議任何條例的責任人都將受到嚴懲，甚可能因此失去工作。
● 滲透測試合同：客戶和滲透測試人員之間的所有技術事宜和業務事宜，都應落實為書面合同。這類合同主要約定測試服務的具體內容、服務的主要目標、測試方法、收費標準，旨在維護整個專案的保密性。因為這種合同全面影響您的滲透測試活動，所以建議您聘請專業律師或法律顧問起草這類合同。
● 操作規則：因為滲透測試可能形成實質性的攻擊，所以測試人員必須清楚地理解評估的需求、客戶配合的範圍，以及每種評估技術可能會造成的影響或後果。此外，滲透測試涉及的測試工具必須配有明確的用途說明，以便測試人員可進行相應的選擇。操作規則非常詳細地明確了上述所有內容，是測試人員在測試過程中必須遵循的技術規範。這一規則的制定依據是事先測算好的資產收益率（ROE）。測試人員不得越過該規則所明確的行為界限。
通過測試計畫的上述各項準備工作，您能夠保證滲透測試流程的統一性。這也有助於測試人員依據客戶需求確定出評估計畫裡的更多細節。我們同時建議您事先準備好測試計畫檢查清單，以驗證評估條款和有關指標。
測試計畫檢查清單
在開始範圍界定的後續工作之前，應當檢查一下您是否完成了先前階段的任務。此時，您可以參考下述這個清單。
● 是否滿足了客戶需求建議書（RFP）的所有需求？
● 是否清晰地描述了測試範圍？
● 是否已經明確了所有參與測試的有關單位？
● 是否已經單獨列出了所有不參與測試的單位？
● 是否需要遵循特定的測試流程？
● 是否正確擬定了測試流程？
● 測試完成後能否交付相應的預期成果？
● 是否書面描述、研究過整個測試環境？
● 是否給所有的測試專案都制定了相應的角色和職責？
● 在涉及特定技術的評估工作中，是否會涉及協力廠商承包商？
● 有沒有採取讓專案能夠完美結束的措施？
● 對方是否有災難恢復計畫？
● 是否已經正式測算過整個項目的成本？
● 是否已經找到了批准測試計畫的責任人？
● 是否已經找到了接受滲透測試的責任人？
3.3 測試邊界分析
客戶提出的專案需求，可能有意或無意地提示出被測環境的局限條件和測試邊界。這些局限條件和測試邊界，可分為技術上的、知識上的或者由客戶設定的正規限制。因為這些約束條件可能會對測試造成重大影響，所以測試人員得通過其他可行方案規避這些問題。必須注意的是，有些限制是無法通融或修改的，因為客戶要通過這些限制來管控整個滲透測試的過程。下文將會介紹常見的限制類型和相應的案例。
● 技術限制：在定義了合適的測試邊界之後，審計人員可能發現目標網路基礎設施中使用了一種無法測試的新型技術，這種類型的限制就是技術限制。發生這種情況的原因是缺乏評估這種新技術的滲透測試工具。例如，XYZ公司引進了一款性能優異的GZ型網路防火牆，他們把GZ部署在網路入口以保護整個內部網路。然而，GZ防火牆運用的專利技術，導致了現有的任何一款防火牆評估工具都無法評估該產品。因此，測試單位需要及時更新解決方案，以解決新技術帶來的評估障礙。
● 知識限制：滲透測試人員在知識能力方面的局限會對整個專案產生負面影響。例如，專門從事資料庫滲透的測試人員，無法負責網路基礎設施的物理安全評估。因此，為了順利完成項目任務, 最好能夠依據人員的知識結構和技能水準分配他們相應的角色和職責。
● 基礎設施有關的其他方面的限制：為了控制評估的實施過程，客戶也可能會添加特定的測試限制。為了實現這種控制，他們可能會限制測試人員僅接觸那些需要被評估的網路設備和技術，而不讓他們接觸 IT 基礎設施的其他部分。通常，需求收集階段的工作應能明確這些限制。例如，客戶可能會要求測試網段A裡的所有設備，但是他們還會同時要求不得測試第一個路由器。客戶需求裡的這種限制，會無法衡量第一個路由器的安全性；即使徹底檢查了網路裡的其他所有設備並保證了其安全，還是這個路由器的問題很有可能引發整個網路的安全事故。 因此，在接受這類限制之前，必須認真地考慮全域問題。
評估人員務必在用戶需求收集階段，仔細觀察、深入分析所有的局限條件和限制要求。優秀的滲透測試人員應能仔細分辨每一個相關需求，應能與客戶進行討論，取消或者改變所有可能造成測試流程意外中斷，或者造成測試結果歧義的限制。雖然本質上說，無法規避某些技術上的限制，而且需要額外的時間來開發克服相應限制的測試方案，但是引入高水準的測試人員，使用先進的測試工具和技術，也可能克服這些限制。
3.4 定義業務指標
在明確評估需求和簽署服務協定之後，下一步工作就是定義業務指標。這將保證測試結果能夠給客戶的業務帶來各個方面的好處。每一項業務指標都對應著相應的評估需求，把安全評估的成果展現為業務的業績。我們整理出一些普遍適用於各類滲透測試項目的業務指標。然而，您也可能根據客戶的需求重新設計這份清單。這個工作十分重要，審計人員應當能夠觀察、理解客戶的業務出發點，在測試前、測試中、測試後都滿足最低程度的指標。管理團隊和技術團隊通力合作，以保證業務可靠性為命題，以增強資訊系統安全性為著手點，共同制定業務指標。無論何種類型的安全評估項目，均可參考下述這個通用的業務指標。
● 通過常規安全檢査，提髙企業形象和業內認可程度。
● 以保證業務完整性為契機，達到必要的標準和規範。
● 提高存有客戶、員工和其他業務單位資訊的機要系統的安全性。
● 在網路基礎設施中排查現有的威脅和已知漏洞，協助建立安全制度以及可對抗已知和未知風險的工作流程。
● 提供一個可平滑過渡的、健全的業務組織架構，從而使合作夥伴和客戶能夠受益。
● 把維護 IT 基礎設施安全性的費用降到最低。安全評估業務可衡量業務系統的保密性、完整性和可用性。
● 説明客戶消除所有尚未被對手惡意利用的潛在風險，避免潛在事故可能造成的損失，從而提高了投資回報率（ROI）。
● 評估人員向客戶技術團隊推薦的詳細的安全流程，可説明客戶消除有關的安全隱患，最終減少客戶的運營負擔。
● 根據目標資訊系統所採用的底層技術，以業內相應的最佳安全實踐為藍本，配合最佳組合的工具和技術，對被測單位的資訊系統進行安全評估。
● 推薦所有可用於保護經營性資產的安全解決方案。
3.5 專案管理和統籌調度
要管理好滲透測試專案，就要徹底瞭解範圍界定流程中的各個部分。一旦明確了範圍目標，專案主管就可以與滲透測試人員協作，共同開發一個擬定好專案計畫和時間進度的正式大綱。雖然滲透測試人員通常可以獨立完成這個任務，但是讓客戶參與進來更好，因為他們會在有關的排程上給予積極的配合。專案管理和進度安排非常重要，因為在執行測試任務時必須精確保持進度，避免超出預定的時間。在滲透測試過程中，一旦給相關任務明確指派了合適的資源之後，就更有必要給與之有關的關鍵任務擬定進度安排。
所謂“任務”，就是由滲透測試人完成的一部分工作。而“資源”可以是安全評估中涉及的人員，也可以是在測試過程中的普通資源，例如實驗器材。我們可以使用許多現有的專案管理工具，把專案管理得高效而划算。下文列出了一些項目管理工具。您可根據實際環境和客戶需求來選擇最佳的工具。
 
上述每個工具的功能都很強大。應用這些工具，參照預定任務和時間規劃，專案管理主管可以輕鬆地追蹤、管理滲透測試人員的工作進度。此外，這些工具都提供了非常高級的功能。例如，在任務完成和超過期限時，這些工具可以給專案主管發送警報資訊。實際上，在滲透測試工作中應用專案管理工具的好處有很多。例如能夠促進人們按時完成任務，提高測試生產力和客戶滿意度，改善工作的質和量，靈活地控制工作流程等。
3.6 本章總結
本章介紹了滲透測試工作裡與範圍界定有關的部分。如果您準備啟動專業的滲透測試專案，就應當充分重視這部分工作。本章介紹的內容主要是確定測試需求方面的必要規範。基於這個目的，本章強調並詳細描述了範圍界定流程的每一個相關步驟。這些步驟構成了實施測試所需的程序控制路線圖。範圍界定流程由 5 個獨立的元素組成：收集需求、籌畫工作、邊界分析、明確業務指標、專案管理和統籌調度。範圍界定流程的工作，旨在於獲取、管理盡可能多的與目標環境有關的資訊，這部分資訊在整個滲透測試的過程裡都將起到舉足輕重的作用。下面，我們總結一下範圍界定流程工作的每個組成部分。
● 收集需求：從客戶或者使用者那裡收集什麼資訊才能成功完成滲透測試任務？這部分內容提供一個可行的通用準則。在這個階段的工作應當明確滲透測試的類型、基礎設施資訊、組織結構關係、預算概要、時間分配和交付成果的具體類型。
● 籌畫工作：這個階段的工作分為制定嚴謹的測試流程、解決人員配置、成本分析、保密協議、滲透測試合同以及操作規則的問題。這些工作內容本身就夠成了制定正式測試計畫所需的各個流程。最終制定的測試計畫應能準確反映客戶需求，應能全面解決測試工作會涉及的法律層面和業務領域的各種問題，應能合理分配資源，適當控制成本，並明確操作規則。另外，本章還有一個測試計畫檢査清單的樣本，它會有助於保證測試計畫的完整性。
● 邊界分析：介紹了在解讀客戶需求時，需要注意何種的局限條件和測試邊界。它們主要分為技術上的限制、知識限制，或者客戶為了控制滲透測試流程而提出的基礎設施有關的其他方面的限制。專業人員應能根據客戶的需求，準確清晰地判斷出各種測試邊界。有一些特定的流程可用於克服這些問題。
● 明確業務指標：這個階段的工作主要關注滲透測試服務能夠給客戶帶來的關鍵效益。本章的這一小節提供了一系列的業務指標，這些指標結合了評估準則和評估服務的專業效果。
● 專案管理和統籌調度：在範圍界定流程裡，這個階段的工作至關重要。當收集好全部需求，並將之整理為測試計畫的有關內容之後，就需要為每項任務分配適當的資源和時間。我們可以通過使用先進的專案管理工具，毫不費力地跟蹤這些任務的進度狀況和資源狀態。這些工作有助於提髙測試的生產力和工作效率。
下一章將介紹在滲透測試中扮演重要角色的偵察流程。它包括探測公共資源、DNS 伺服器、搜尋引擎以及其他有關目標基礎設施的邏輯資訊。




```
